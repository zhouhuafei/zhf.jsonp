"use strict";var extend=require("zhf.extend"),qs=require("zhf.query-string");module.exports=function(e){var r=extend({url:"",data:{},isHandleError:!0,isHandleFailure:!0,callback:function(){}},e),a=r.url,t=r.data,n=r.callback;function i(){var e={status:"error",message:"接口出错",error:"Request failed with status code 404"};n(e),r.isHandleError&&alert("Error: "+e.error)}if(a){var d=(""+Math.random()).substring(2),l="jsonpCallback"+(new Date).getTime()+d;window[l]=function(e){n(e),"failure"===e.status&&r.isHandleFailure&&alert("失败: "+e.message)};var o=document.createElement("script");o.addEventListener("error",function(){document.body.removeChild(o),i()}),o.addEventListener("load",function(){document.body.removeChild(o)});var s=qs.queryStringify(t);o.src=s?a+"?"+s+"&callback="+l:a+"?callback="+l,document.body.appendChild(o)}else i()};